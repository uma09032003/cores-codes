/*Design a Student Management DataBase that has the package with the necessary procedures to insert Student Marks and  automate calculating Student Grade and GPA.*/ 
/*Creating a Table*/ 

create table sm(
   student_id varchar(5) primary key,
   Mark1 int default -1,
   Mark2 int default -1,
   Grade char(1) default 'N',
   GPA int);
   
/*Creating Package Specification*/ 
 create or replace package smp as
   M1 int;
   M2 int;
   S1 varchar(5);
   procedure insstd (s sm.student_id%type);
   procedure insmark (s varchar, a int, b int);
   procedure findgrade;
   procedure findgpa;
   end smp;
   /

/*Creating Package Body inside the file Packagebodysmp.sql*/
create or replace package body smp as 
procedure insstd (s sm.student_id%type) is 
begin
insert into sm (student_id) values (s);
dbms_output.put_line('Value inserted');
end;
procedure findgrade is 
begin
case 
when M1+M2>=90 and M1+M2<=100 then 
update sm set grade='S' where student_id=S1;
when M1+M2>=80 then
update sm set grade='A' where student_id=S1;
when M1+M2>=70 then 
update sm set grade='B' where student_id=S1;
when M1+M2>=60 then 
update sm set grade='C' where student_id=S1;
when M1+M2>=50 then 
update sm set grade='D' where student_id=S1;
else
update sm set grade='F' where student_id=S1; 
end case;
end;
procedure findgpa is 
begin
update sm set gpa=(M1+M2)/10 where grade<>'F' and student_id=S1;
end;
procedure insmark ( s varchar, a int, b int) is 
begin
update sm set Mark1=a,Mark2=b where student_id=s; 
M1:=a;
M2:=b;
S1:=s;
findgrade;
findgpa;
M1:=0;
M2:=0;
S1:='0';
end;
end smp;
/

/* Using the smp Package inside the smpdemo.sql */ 
begin
smp.insstd('63391');
smp.insstd('63392');
smp.insmark('63391',48,44);
smp.insmark('63392',46,33);
end;
/

/*Displaying resulting records from the Table*/ 
select * from sm;
